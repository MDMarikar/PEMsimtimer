
<!DOCTYPE html>
<html>

<head>
  <!-- Include meta tag to ensure proper rendering and touch zooming -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <!-- Include jQuery Mobile stylesheets -->
  <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
  <!-- Include the jQuery library -->
  <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
  <!-- Include the jQuery Mobile library -->
  <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  <!-- timecircles -->
  <link rel="stylesheet" href="http://git.wimbarelds.nl/TimeCircles/inc/TimeCircles.css">
  <script src="http://git.wimbarelds.nl/TimeCircles/inc/TimeCircles.js"></script>
  <script src="https://code.highcharts.com/stock/highstock.js"></script>


  <script src="https://code.highcharts.com/highcharts-more.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>


  <style>
  
   .ui-page { 
    background:#2b2e31;
    }
    
    .ui-grid-a { 
    background:purple;
    }
    
    
    label {
      font-weight: bold;
    }
    
    body {
      font-size: 80%;
      
    }
    
    h2
    {
      
      color: red;
    }
    
    h3
    {
      
      color: orange;
    }
    
    div {
      cursor: pointer;
    }
    
  
    
    
    .simtimer {
      background: purple;
      width: 200px;
      height: 80px;
    }
    
    .inlineinput div {
      display: inline;
    }
    
    table,
    td,
    th {
      border: 1px solid black;
      text-align: center;
      background: grey;
    }
    
    table {
      table-layout: auto;
      border-collapse: collapse;
      width: 80%;
    }
    
    th {
      text-align: center;
    }
  </style>

  <script>
    $(document).ready(function() {
      
     
      $(":input").val(0);
      var simtimer = getTimecircle();
      var hashtag = "#";
      var resettstr = "R";
      
      
      setupSetup();
      
      $('select').change(function(){
        
      var index = $(this).val();
       templateChange(index); 
      });
    
      //when number is selected, put cursor at end
      $(':input[type="number"]').click( function(){
        var x = $(this).val();
        $(this).val(x);

      }); 
      
      $('a').click(function(e) {
        
        //console.log(e.target.id);
        
        if (e.target.id == "start")
        {
          simtimer.start();
          return;
          
        }
        
        if (e.target.id == "pause")
        {
          simtimer.stop();
          return;
          
        }
        
        if (e.target.id == "reset")
        {
          location.reload();
          return;
          
        }
        
   
        
        if (e.target.id =="tableview")
        {
          
          updatetableview();
          return;
        }

        if (e.target.id =="circleview")
        {
          
            circleprep();
            return;
        }
        
        
        
        
        if (e.target.id == "graphing") {
          graphprep();
          return;
        }
        
        if (e.target.id == "returnToSim") {
          try {
        
            
            $("#KPLabelling").text("Main Problem: " + $("#KPSetup").val());
            $("#KTLabelling").text("Definitive Treatment: " + $("#KTSetup").val());
            $("#AirWayLabelling").text($("#AirWaySetup").val());
            $("#BLabelling").text($("#BSetup").val());
            $("#CLabelling").text($("#CSetup").val());
            $("#DLabelling").text($("#DSetup").val());
            $("#ELabelling").text($("#ESetup").val());
          } catch (err) {
            alert(err);
          }
          return;
        }
        
        
        var t = simtimer.getTime();
        t = Math.round(Math.abs(t));
        var secs = t % 60;
        var mins = Math.floor(t / 60);
        var target = $(e.target);
        var resetting = target.attr('id').includes('R');
        var inputelement = hashtag + target.attr('id');
        if (resetting) {
          inputelement = inputelement.substring(0, inputelement.length - 1);
        }
        
        //alert(inputelement);
        var inputsecs = inputelement + "secsInput";
        var inputmins = inputelement + "minsInput";
        if (resetting) {
          $(inputsecs).val(0);
          $(inputmins).val(0);
        } else {
          $(inputsecs).val(secs);
          $(inputmins).val(mins);
        }
      });
    });
    function getTimecircle() {
      return $(".simtimer").TimeCircles({
        start: false,
        time: {
          Days: {
            color: "#C0C8CF",
            show: false
          },
          Hours: {
            color: "#C0C8CF",
            show: false
          },
          Minutes: {
            color: "#C0C8CF"
          },
          Seconds: {
            color: "#C0C8CF"
          }
        }
      });
    }
    
    function setupSetup() {
      $('#AirWaySetup').val("Airway Event");
      $('#BSetup').val("Breathing Event");
      $('#CSetup').val("Circulation Event");
      $('#DSetup').val("Disability Event");
      $('#ESetup').val("Exposure Event");
      $('#KPSetup').val("Key Problem");
      $('#KTSetup').val("Definitive Treatment");
    }
    
    function templateChange(index)
    {
      
      if (index == 1) //none
      {
        
        $('#AirWaySetup').val("Airway Event");
        $('#BSetup').val("Breathing Event");
        $('#CSetup').val("Circulation Event");
        $('#DSetup').val("Disability Event");
        $('#ESetup').val("Exposure Event");
        $('#KPSetup').val("Key Problem");
        $('#KTSetup').val("Definitive Treatment");
      }
      else if (index == 2) //sepsis
      {
        
        $('#AirWaySetup').val("No active problem");
        $('#BSetup').val("Desaturation - O2");
        $('#CSetup').val("Hypotension - fluid bolus");
        $('#DSetup').val("Hypoglycaemia - dextrose bolus");
        $('#ESetup').val("Non blanching rash");
        $('#KPSetup').val("Sepsis");
        $('#KTSetup').val("IV Ceftriaxone");
      }
      else if (index == 3) //anaphylaxis
      {
             
        $('#AirWaySetup').val("Stridor");
        $('#BSetup').val("Desaturation");
        $('#CSetup').val("Hypotension");
        $('#DSetup').val("Drowsiness");
        $('#ESetup').val("Urticaria");
        $('#KPSetup').val("Anaphylaxis");
        $('#KTSetup').val("IM Adrenaline");
      }
      else if (index == 4) //status
      {
        
        $('#AirWaySetup').val("No active problem");
        $('#BSetup').val("Desaturation");
        $('#CSetup').val("IV Access for Status Epilepticus");
        $('#DSetup').val("Seizure");
        $('#ESetup').val("No active problem");
        $('#KPSetup').val("Status Epilepticus");
        $('#KTSetup').val("Benzodiazepine administration");
      }
      
    }
    
    function updatetableview()
    {
      
      
        //Tasks
        console.log("***");
       $("[data-simtasktype]").each(function(){
        var eventTypeID = "#"+$(this).data("simtasktype");
        console.log(eventTypeID);
        var eventTypeText = $(eventTypeID).text();
        console.log(eventTypeText);
        console.log($(this).text());
        $(this).text(eventTypeText);
        console.log($(this).text());
        //$("#"+(this).attr("id")).text(eventTypeText);
        console.log("***");
    });
    
       //Task Descriptions
       console.log("**desc*");
       $("[data-taskdesc]").each(function(){
        var descID = "#"+$(this).data("taskdesc");
        console.log(descID);
        var descText = $(descID).text();
        console.log(descText);
        console.log($(this).text());
        $(this).text(descText);
        console.log($(this).text());
        //$("#"+(this).attr("id")).text(eventTypeText);
        console.log("**desc*");
       });
       
       
       populatetablenumeric("omins");
       populatetablenumeric("osecs");
       populatetablenumeric("imins");
       populatetablenumeric("isecs");
        populatetablenumeric("tmins");
       populatetablenumeric("tsecs");
       
       
       
       
      
    }
    
    //populates the results table using ids of asssociated
    //numeric input elements
    function populatetablenumeric(attribute_name)
    {
      
      var attribute_tag = $("[data-"+attribute_name+"]");
      $(attribute_tag).each(function(){
        
        var idfield = "#"+$(this).data(attribute_name);
        console.log("***"+idfield);
        console.log(idfield);
        var idval = $(idfield).val();
        console.log(idval);
        if ((idval == "") || (idval == null))
          idval = 0;
        console.log($(this).text());
        $(this).text(idval);
        console.log($(this).text());
        //$("#"+(this).attr("id")).text(eventTypeText);
        console.log("***"+idfield);
        
        
        
        
      });
      
      
      
    }
    
  </script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99834207-1', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body>



<!-- main page -->

  <div data-role="page" id="pageone" data-theme="b">





    <div data-role="header" data-position="fixed">
      <div class="ui-grid-a">
      <div class="simtimer ui-block-a" style="width: 75%" data-timer="0"></div>
      <div class="ui-block-b" style="width:25%;font-size: 35px"><a href=https://em3.org.uk/ target="_blank">#EM3</a></div><p>(prototype)</p>
      </div>
      <div class="ui-grid-f">
        <!--
        <input type="button" id="start" value="start">
        <input type="button" id="pause" value="pause">
        <input type="button" id="reset" value="reset">
        -->
        
        <div class="ui-block-a"><a href="#start" id="start" class="ui-corner-all ui-shadow ui-btn ui-icon-carat-r ui-btn-icon-top">start</a></div>
        <div class="ui-block-b"><a href="#pause" id="pause" class="ui-corner-all ui-shadow ui-btn ui-icon-bars ui-btn-icon-top">pause</a></div>
        <div class="ui-block-c"><a href="#reset" id="reset" class="ui-corner-all ui-shadow ui-btn ui-icon-refresh ui-btn-icon-top">reset</a></div>
        <div class="ui-block-d"><a href="#pagetwo" class="ui-corner-all ui-shadow ui-btn ui-icon-eye ui-btn-icon-top" id="graphing">debrief</a></div>
        <div class="ui-block-e"><a href="#setUpMenu" class="ui-corner-all ui-shadow ui-btn ui-icon-gear ui-btn-icon-top" id="setup">setup labels</a></div>
        <div class="ui-block-e"><a href="#info" class="ui-corner-all ui-shadow ui-btn ui-icon-info ui-btn-icon-top" id="setup">info</a></div>


      </div>

    </div>

    <div data-role="main" class="ui-content" >
      <h2 id="atask">A</h2>
      <h3 id="AirWayLabelling">Airway Task</h3>


      <table data-role="table" class="ui-responsive">
        <thead>
          <tr>
            <th>Occured
              <a href="#" id="A1timemarkI" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="A1timemarkIR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Identified
              <a href="#" id="A1timemarkO" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="A1timemarkOR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Treated
              <a href="#" id="A1timemarkT" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="A1timemarkTR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>

              <div>
                <span class="inlineinput">
                <input type='number' id="A1timemarkIminsInput" max="60" maxlength="2" align="left"  style='display: inline; width: 50px;' />min
              </span>

                <span class="inlineinput">
                <input type='number' id="A1timemarkIsecsInput" max="60" maxlength="2" align="left" style='display: inline; width: 50px;' />sec
              </span>

              </div>
            </td>
            <td>
              <div>
                <span class="inlineinput">
            <input type='number' id="A1timemarkOminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
            </span>

                <span class="inlineinput">
            <input type='number' id="A1timemarkOsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
            </span>
              </div>
            </td>

            <td>
              <div>
                <span class="inlineinput">
          <input type='number' id="A1timemarkTminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
          </span>

                <span class="inlineinput">
          <input type='number' id="A1timemarkTsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
          </span>
              </div>

            </td>
          </tr>

        </tbody>
      </table>

      <!-- B Task -->
      <h2 id="btask">B</h2>
      <h3 id="BLabelling">Breathing Task</h3>

      <table data-role="table" class="ui-responsive">
        <thead>
          <tr>
            <th>Occured
              <a href="#" id="B1timemarkI" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="B1timemarkIR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Identified
              <a href="#" id="B1timemarkO" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="B1timemarkOR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Treated
              <a href="#" id="B1timemarkT" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="B1timemarkTR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>

              <div>
                <span class="inlineinput">
                <input type='number' id="B1timemarkIminsInput" max="60" maxlength="2" align="left"  style='display: inline; width: 50px;' />min
              </span>

                <span class="inlineinput">
                <input type='number' id="B1timemarkIsecsInput" max="60" maxlength="2" align="left" style='display: inline; width: 50px;' />sec
              </span>

              </div>
            </td>
            <td>
              <div>
                <span class="inlineinput">
            <input type='number' id="B1timemarkOminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
            </span>

                <span class="inlineinput">
            <input type='number' id="B1timemarkOsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
            </span>
              </div>
            </td>

            <td>
              <div>
                <span class="inlineinput">
          <input type='number' id="B1timemarkTminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
          </span>

                <span class="inlineinput">
          <input type='number' id="B1timemarkTsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
          </span>
              </div>

            </td>
          </tr>

        </tbody>
      </table>

      <!-- C Task -->
      <h2 id="ctask">C</h2>
      <h3 id="CLabelling">Circulation Task</h3>

      <table data-role="table" class="ui-responsive">
        <thead>
          <tr>
            <th>Occured
              <a href="#" id="C1timemarkI" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="C1timemarkIR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Identified
              <a href="#" id="C1timemarkO" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="C1timemarkOR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Treated
              <a href="#" id="C1timemarkT" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="C1timemarkTR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>

              <div>
                <span class="inlineinput">
                <input type='number' id="C1timemarkIminsInput" max="60" maxlength="2" align="left"  style='display: inline; width: 50px;' />min
              </span>

                <span class="inlineinput">
                <input type='number' id="C1timemarkIsecsInput" max="60" maxlength="2" align="left" style='display: inline; width: 50px;' />sec
              </span>

              </div>
            </td>
            <td>
              <div>
                <span class="inlineinput">
            <input type='number' id="C1timemarkOminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
            </span>

                <span class="inlineinput">
            <input type='number' id="C1timemarkOsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
            </span>
              </div>
            </td>

            <td>
              <div>
                <span class="inlineinput">
          <input type='number' id="C1timemarkTminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
          </span>

                <span class="inlineinput">
          <input type='number' id="C1timemarkTsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
          </span>
              </div>

            </td>
          </tr>

        </tbody>
      </table>
      
      <!-- D Task -->
      <h2 id="dtask">D</h2>
      <h3 id="DLabelling">Disability Task</h3>


      <table data-role="table" class="ui-responsive">
        <thead>
          <tr>
            <th>Occured
              <a href="#" id="D1timemarkI" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="D1timemarkIR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Identified
              <a href="#" id="D1timemarkO" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="D1timemarkOR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Treated
              <a href="#" id="D1timemarkT" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="D1timemarkTR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>

              <div>
                <span class="inlineinput">
                <input type='number' id="D1timemarkIminsInput" max="60" maxlength="2" align="left"  style='display: inline; width: 50px;' />min
              </span>

                <span class="inlineinput">
                <input type='number' id="D1timemarkIsecsInput" max="60" maxlength="2" align="left" style='display: inline; width: 50px;' />sec
              </span>

              </div>
            </td>
            <td>
              <div>
                <span class="inlineinput">
            <input type='number' id="D1timemarkOminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
            </span>

                <span class="inlineinput">
            <input type='number' id="D1timemarkOsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
            </span>
              </div>
            </td>

            <td>
              <div>
                <span class="inlineinput">
          <input type='number' id="D1timemarkTminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
          </span>

                <span class="inlineinput">
          <input type='number' id="D1timemarkTsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
          </span>
              </div>

            </td>
          </tr>

        </tbody>
      </table>

      <!-- E Task -->
      <h2 id="etask">E</h2>
      <h3 id="ELabelling">Exposure Task</h3>

      <table data-role="table" class="ui-responsive">
        <thead>
          <tr>
            <th>Occured
              <a href="#" id="E1timemarkI" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="E1timemarkIR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Identified
              <a href="#" id="E1timemarkO" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="E1timemarkOR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Treated
              <a href="#" id="E1timemarkT" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="E1timemarkTR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>

              <div>
                <span class="inlineinput">
                <input type='number' id="E1timemarkIminsInput" max="60" maxlength="2" align="left"  style='display: inline; width: 50px;' />min
              </span>

                <span class="inlineinput">
                <input type='number' id="E1timemarkIsecsInput" max="60" maxlength="2" align="left" style='display: inline; width: 50px;' />sec
              </span>

              </div>
            </td>
            <td>
              <div>
                <span class="inlineinput">
            <input type='number' id="E1timemarkOminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
            </span>

                <span class="inlineinput">
            <input type='number' id="E1timemarkOsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
            </span>
              </div>
            </td>

            <td>
              <div>
                <span class="inlineinput">
          <input type='number' id="E1timemarkTminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
          </span>

                <span class="inlineinput">
          <input type='number' id="E1timemarkTsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
          </span>
              </div>

            </td>
          </tr>

        </tbody>
      </table>

      <!-- Key Moments Task -->
      <h2>Key Moments</h2>
      <h3 id="KPLabelling">Main Problem</h3>
      <h3 id="KTLabelling">Definitive Treatment</h3>



      <table data-role="table" class="ui-responsive">
        <thead>
          <tr>


            <th>Main Problem Identified

              <a href="#" id="K1timemarkI" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="K1timemarkIR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>

            <th>Definitive Treatment

              <a href="#" id="K1timemarkT" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext">Plus</a>
              <a href="#" id="K1timemarkTR" class="ui-btn ui-btn-inline ui-shadow ui-corner-all ui-icon-delete ui-btn-icon-notext">Minus</a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <div>
                <span class="inlineinput">
            <input type='number' id="K1timemarkIminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
            </span>

                <span class="inlineinput">
            <input type='number' id="K1timemarkIsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
            </span>
              </div>
            </td>

            <td>
              <div>
                <span class="inlineinput">
          <input type='number' id="K1timemarkTminsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />min
          </span>

                <span class="inlineinput">
          <input type='number' id="K1timemarkTsecsInput" max="60" maxlength="2"  style='display: inline; width: 50px;' />sec
          </span>
              </div>

            </td>
          </tr>

        </tbody>
      </table>




    </div>




  </div>

<!-- main page end -->


  <div data-role="page" id="pagetwo" data-theme="b">



    <script>
      function gettimevalue(minval, secval) {
        if ((minval == null) && (secval == null)) {
          return null;
        }
        if (minval=="")
          minval=0;
          
        if (secval=="")
          secval=0;
        var x = parseInt(minval, 10) * 60 + parseInt(secval, 10);
        console.log(minval + ":" + secval + ":" + x);
        return x;
      }
      
      function findmaxtimeval() {
        var x = Math.max(
          gettimevalue(document.getElementById("A1timemarkIminsInput").value, document.getElementById("A1timemarkIsecsInput").value),
          gettimevalue(document.getElementById("A1timemarkOminsInput").value, document.getElementById("A1timemarkOsecsInput").value),
          gettimevalue(document.getElementById("B1timemarkIminsInput").value, document.getElementById("B1timemarkIsecsInput").value),
          gettimevalue(document.getElementById("B1timemarkOminsInput").value, document.getElementById("B1timemarkOsecsInput").value),
          gettimevalue(document.getElementById("C1timemarkIminsInput").value, document.getElementById("C1timemarkIsecsInput").value),
          gettimevalue(document.getElementById("C1timemarkOminsInput").value, document.getElementById("C1timemarkOsecsInput").value),
          gettimevalue(document.getElementById("D1timemarkIminsInput").value, document.getElementById("D1timemarkIsecsInput").value),
          gettimevalue(document.getElementById("D1timemarkOminsInput").value, document.getElementById("D1timemarkOsecsInput").value),
          gettimevalue(document.getElementById("E1timemarkIminsInput").value, document.getElementById("E1timemarkIsecsInput").value),
          gettimevalue(document.getElementById("E1timemarkOminsInput").value, document.getElementById("E1timemarkOsecsInput").value),
          gettimevalue(document.getElementById("A1timemarkTminsInput").value, document.getElementById("A1timemarkTsecsInput").value),
          gettimevalue(document.getElementById("B1timemarkTminsInput").value, document.getElementById("B1timemarkTsecsInput").value),
          gettimevalue(document.getElementById("C1timemarkTminsInput").value, document.getElementById("C1timemarkTsecsInput").value),
          gettimevalue(document.getElementById("D1timemarkTminsInput").value, document.getElementById("D1timemarkTsecsInput").value),
          gettimevalue(document.getElementById("E1timemarkTminsInput").value, document.getElementById("E1timemarkTsecsInput").value),
          gettimevalue(document.getElementById("K1timemarkIminsInput").value, document.getElementById("K1timemarkIsecsInput").value),
          gettimevalue(document.getElementById("K1timemarkTminsInput").value, document.getElementById("K1timemarkTsecsInput").value)
        );
        var modval = x % 60;
        return (x - modval + 60);
      }
      function graphprep() {
        //start
        var maxtimeval = findmaxtimeval();
        if (maxtimeval == null) {
          alert("internal error: max time not calculated");
          maxtimeval = 300;
        }
        var keyprobtime = gettimevalue(document.getElementById("K1timemarkIminsInput").value, document.getElementById("K1timemarkIsecsInput").value); // Value of where the line will appear
        if (keyprobtime == 0) {
          keyprobtime = null;
        }
        var keyrxtime = gettimevalue(document.getElementById("K1timemarkTminsInput").value, document.getElementById("K1timemarkTsecsInput").value); // Value of where the line will appear
        if (keyrxtime == 0) {
          keyrxtime = null;
        }
        var identtime = " ("+document.getElementById("K1timemarkIminsInput").value+"m "+ document.getElementById("K1timemarkIsecsInput").value+"s"+")";
        var ttime = " ("+document.getElementById("K1timemarkTminsInput").value+"m "+ document.getElementById("K1timemarkTsecsInput").value+"s"+")";
          
        var container_chartFreqAtaTailNum = new Highcharts.Chart({
          chart:
          {
            events: {
              load: function() {
                var label = this.renderer.label("A: " + $("#AirWaySetup").val())
                  .css({
                    width: 400,
                    height: 100,
                    color: 'black',
                    fontSize: '12px'
                  })
                  .attr({
                    'stroke': 'silver',
                    'stroke-width': 2,
                    'r': 5,
                    'padding': 5
                  })
                  .add();
                label.align(Highcharts.extend(label.getBBox(), {
                  align: 'bottom',
                  x: 0, // offset
                  verticalAlign: 'bottom',
                  y: label.getBBox().height, // offset
                }), null, 'spacingBox');
                var labelB = this.renderer.label("B: " + $("#BSetup").val())
                  .css({
                    width: 400,
                    height: 100,
                    color: 'black',
                    fontSize: '12px'
                  })
                  .attr({
                    'stroke': 'silver',
                    'stroke-width': 2,
                    'r': 5,
                    'padding': 5
                  })
                  .add();
                labelB.align(Highcharts.extend(label.getBBox(), {
                  align: 'bottom',
                  x: label.getBBox().width, // offset
                  verticalAlign: 'bottom',
                  y: label.getBBox().height, // offset
                }), null, 'spacingBox');
                var labelC = this.renderer.label("C: " + $("#CSetup").val())
                  .css({
                    width: 400,
                    height: 100,
                    color: 'black',
                    fontSize: '12px'
                  })
                  .attr({
                    'stroke': 'silver',
                    'stroke-width': 2,
                    'r': 5,
                    'padding': 5
                  })
                  .add();
                labelC.align(Highcharts.extend(label.getBBox(), {
                  align: 'bottom',
                  x: 0, // offset
                  verticalAlign: 'bottom',
                  y: label.getBBox().height * 2, // offset
                }), null, 'spacingBox');
                var labelD = this.renderer.label("D: " + $("#DSetup").val())
                  .css({
                    width: 400,
                    height: 100,
                    color: 'black',
                    fontSize: '12px'
                  })
                  .attr({
                    'stroke': 'silver',
                    'stroke-width': 2,
                    'r': 5,
                    'padding': 5
                  })
                  .add();
                labelD.align(Highcharts.extend(label.getBBox(), {
                  align: 'bottom',
                  x: labelC.getBBox().width, // offset
                  verticalAlign: 'bottom',
                  y: label.getBBox().height * 2, // offset
                }), null, 'spacingBox');
                var labelE = this.renderer.label("E: " + $("#ESetup").val())
                  .css({
                    width: 400,
                    height: 100,
                    color: 'black',
                    fontSize: '12px'
                  })
                  .attr({
                    'stroke': 'silver',
                    'stroke-width': 2,
                    'r': 5,
                    'padding': 5
                  })
                  .add();
                labelE.align(Highcharts.extend(label.getBBox(), {
                  align: 'bottom',
                  x: labelC.getBBox().width + labelD.getBBox().width, // offset
                  verticalAlign: 'bottom',
                  y: label.getBBox().height * 2, // offset
                }), null, 'spacingBox');
                var labelKP = this.renderer.label("Key Problem: " + $("#KPSetup").val())
                  .css({
                    width: 400,
                    height: 100,
                    color: 'black',
                    fontSize: '12px'
                  })
                  .attr({
                    'stroke': 'silver',
                    'stroke-width': 2,
                    'r': 5,
                    'padding': 5
                  })
                  .add();
                labelKP.align(Highcharts.extend(label.getBBox(), {
                  align: 'bottom',
                  x: 0, // offset
                  verticalAlign: 'bottom',
                  y: label.getBBox().height * 2 + labelC.getBBox().height // offset
                }), null, 'spacingBox');
                var labelKT = this.renderer.label("Definitive Treatment: " + $("#KTSetup").val())
                  .css({
                    width: 400,
                    height: 100,
                    color: 'black',
                    fontSize: '12px'
                  })
                  .attr({
                    'stroke': 'silver',
                    'stroke-width': 2,
                    'r': 5,
                    'padding': 5
                  })
                  .add();
                labelKT.align(Highcharts.extend(label.getBBox(), {
                  align: 'bottom',
                  x: labelKP.getBBox().width, // offset
                  verticalAlign: 'bottom',
                  y: label.getBBox().height * 2 + labelC.getBBox().height // offset// offset
                }), null, 'spacingBox');
              }
            },
            spacingBottom: 100,
            type: 'columnrange',
            inverted: true,
            renderTo: 'container'
          },
          tooltip: {
            enabled: false
          },
          credits: {
            enabled: false
          },
          title: {
            text: 'Simulation Feedback'
          },
          subtitle: {
            text: ''
          },
          xAxis: {
            categories: ['A', 'B', 'C', 'D', 'E']
          },
          scrollbar: {
            enabled: true
          },
          yAxis: {
            plotLines: [{
                useHTML: true,
                color: 'red', // Color value
                label: {
                  text: 'main problem identified'+identtime,
                  verticalAlign: 'top',
                  rotation: 0
                },
                value: keyprobtime,
                width: 2 // Width of the line
              },
              {
                color: 'blue', // Color value
                label: {
                  text: 'key rx'+ttime,
                  verticalAlign: 'bottom',
                  rotation: 0
                },
                value: keyrxtime, // Value of where the line will appear
                width: 2 // Width of the line
              }
            ],
            min: 0,
            max: maxtimeval,
            tickInterval: 60,
            title: {
              text: 'Time (min)'
            },
            labels: {
              formatter: function() {
                return Math.floor(this.value / 60) + 'm';
              }
            },
          },
          plotOptions: {
            columnrange: {
              grouping: true,
              maxPointWidth: 100,
              borderColor: 'black',
              dataLabels: {
                enabled: true,
                align: 'top',
                formatter: function() {
                  var labelstring = '';
                  var minval = 0;
                  var minval = Math.floor(this.y / 60);
                  if (minval != 0) {
                    var labelstring = minval + 'm ';
                  }
                  labelstring = labelstring + this.y % 60 + 's';
                  return labelstring;
                }
              }
            }
          },
          legend: {
            enabled: true,
            align: 'right'
          },
          
            tooltip: {
        useHTML : true,
        headerFormat: '<b>{series.name}</b><br>',
        formatter: function() {

          var labelstring = '';
          var minval = 0;
          var minval = Math.floor(this.y / 60);

          if (minval != 0) {
            var labelstring = minval + 'm ';
          }
          
          var mytask="null";
          if (this.x=="A")
          {
            mytask = $("#AirWaySetup").val();
          }
          else if (this.x=="B")
          {
            mytask = $("#BSetup").val();
          }
          else if (this.x=="C")
          {
            mytask = $("#CSetup").val();
          }
          else if (this.x=="D")
          {
            mytask = $("#DSetup").val();
          }
          else if (this.x=="E")
          {
            mytask = $("#ESetup").val();
          }
          
          
          labelstring = "<b>" + mytask + "</b>" + "<br/>" + "(" + this.series.name + ")";

          return labelstring;
        },
        

    },
          
          
          series: [{
              name: 'From problem occurence to identification',
              enabled: false,
              data: [
                [gettimevalue(document.getElementById("A1timemarkIminsInput").value, document.getElementById("A1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("A1timemarkOminsInput").value, document.getElementById("A1timemarkOsecsInput").value)
                ],
                [gettimevalue(document.getElementById("B1timemarkIminsInput").value, document.getElementById("B1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("B1timemarkOminsInput").value, document.getElementById("B1timemarkOsecsInput").value)
                ],
                [gettimevalue(document.getElementById("C1timemarkIminsInput").value, document.getElementById("C1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("C1timemarkOminsInput").value, document.getElementById("C1timemarkOsecsInput").value)
                ],
                [gettimevalue(document.getElementById("D1timemarkIminsInput").value, document.getElementById("D1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("D1timemarkOminsInput").value, document.getElementById("D1timemarkOsecsInput").value)
                ],
                [gettimevalue(document.getElementById("E1timemarkIminsInput").value, document.getElementById("E1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("E1timemarkOminsInput").value, document.getElementById("E1timemarkOsecsInput").value)
                ]
              ],
              dataLabels: {
                enabled: true,
                xLow: -10,
                xHigh: 20,
              },
              color: 'red'
            },
            {
              name: 'From problem occurence to treatment',
              data: [
                [gettimevalue(document.getElementById("A1timemarkIminsInput").value, document.getElementById("A1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("A1timemarkTminsInput").value, document.getElementById("A1timemarkTsecsInput").value)
                ],
                [gettimevalue(document.getElementById("B1timemarkIminsInput").value, document.getElementById("B1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("B1timemarkTminsInput").value, document.getElementById("B1timemarkTsecsInput").value)
                ],
                [gettimevalue(document.getElementById("C1timemarkIminsInput").value, document.getElementById("C1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("C1timemarkTminsInput").value, document.getElementById("C1timemarkTsecsInput").value)
                ],
                [gettimevalue(document.getElementById("D1timemarkIminsInput").value, document.getElementById("D1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("D1timemarkTminsInput").value, document.getElementById("D1timemarkTsecsInput").value)
                ],
                [gettimevalue(document.getElementById("E1timemarkIminsInput").value, document.getElementById("E1timemarkIsecsInput").value),
                  gettimevalue(document.getElementById("E1timemarkTminsInput").value, document.getElementById("E1timemarkTsecsInput").value)
                ]
              ],
              dataLabels: {
                enabled: true,
                xLow: -10,
                xHigh: 20,
              },
              color: 'blue'
            }
          ]
          //dil
        });
        //end
      }
    </script>


    <div data-role="header" data-position="fixed" data-theme="b">
      <div data-role="controlgroup" data-type="horizontal">
          
          <a href="#pageone" class="ui-btn" id="returnToSim">Return to simulation</a>
          <a href="#circleview" class="ui-btn" id="circleview">circle view</a>
          <a href="#tableview" class="ui-btn" id="tableview">table view</a>
          


      </div>
    
    </div>

    <div data-role="main" class="ui-content">


      <div id="container"></div>


    </div>




  </div>


  <div data-role="page" id="setUpMenu" class="ui-corner-all" data-theme="b">
    
    
    
    <div data-role="header" data-position="fixed" data-theme="b">
      
      <div data-role="controlgroup" data-type="horizontal">
          
          <a href="#pageone" class="ui-btn" id="returnToSim">Return to simulation</a>

      </div>
    
    </div>

    <div data-role="main" class="ui-content">

      <div style="padding:10px 20px;">
        <h3>Setup simulation labels</h3>
        
      
        <div class="ui-field-contain">
                <label for="template">Scenario:</label>
                <select name="template" id="template" data-mini="true">
                    <option value="1">New Scenario</option>
                    <option value="2">Sepsis</option>
                    <option value="3" selected="selected">Anaphylaxis</option>
                    <option value="4">Status Epilepticus</option>
                </select>
        </div>
        
        
        <div class="ui-field-contain">
          <label for="AirWaySetup">A</label>
          <input type="text" name="AirWaySetup" id="AirWaySetup" value="Airway Task" placeholder="Airway Task" />
        </div>

        <div class="ui-field-contain">
          <label for="BSetup">B</label>
          <input type="text" name="BSetup" id="BSetup" value="Breathing Task" placeholder="Breathing Task" />
        </div>

        <div class="ui-field-contain">
          <label for="CSetup">C</label>
          <input type="text" name="CSetup" id="CSetup" value="C Task" placeholder="C Task" />
        </div>

        <div class="ui-field-contain">
          <label for="DSetup">D</label>
          <input type="text" name="DSetup" id="DSetup" value="D Task" placeholder="D Task" />
        </div>

        <div class="ui-field-contain">
          <label for="ESetup">E</label>
          <input type="text" name="ESetup" id="ESetup" value="E Task" placeholder="E Task" />
        </div>

        <div class="ui-field-contain">
          <label for="KPsetup">Key Problem Identified</label>
          <input type="text" name="KPSetup" id="KPSetup" value="Key Problem" placeholder="Key Problem" />
        </div>

        <div class="ui-field-contain">
          <label for="KTsetup">Key Treatment</label>
          <input type="text" name="KTSetup" id="KTSetup" value="Key Treatment" placeholder="Key Treatment" />
        </div>



      </div>

    </div>

  </div>

<!-- new page for table view -->



  <div data-role="page" id="tableview" class="ui-corner-all" data-theme="b">
      <div data-role="header" data-position="fixed" data-theme="b">
        
      
        
        <div data-role="controlgroup" data-type="horizontal">
          
          <a href="#pageone" class="ui-btn" id="returnToSim">Return to simulation</a>
          <a href="#pagetwo" class="ui-btn" id="graphing">graph view</a>
          <a href="#circleview" class="ui-btn" id="circleview">circle view</a>



        
        </div>
        </div> <!-- header end -->

      <div data-role="main" class="ui-content">
      
        <!--airway task -->
        <div class="ui-corner-all">
          
          <div class="ui-bar ui-bar-b">
            
            <h3 data-simtasktype="atask">AAAAAAAA</h3>
            <h3 data-taskdesc="AirWayLabelling">description</h3>
          </div>
            
            <div class="ui-grid-b">
					    <div class="ui-block-a"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Occured</h1><p></p><h2><span data-omins="A1timemarkIminsInput"/>0</span>m <span data-osecs="A1timemarkIsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-b"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Identified</h1><p></p><h2><span data-imins="A1timemarkOminsInput"/>0</span>m <span data-isecs="A1timemarkOsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-c"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Treated</h1><p></p><h2><span data-tmins="A1timemarkTminsInput"/>0</span>m <span data-tsecs="A1timemarkTsecsInput">0</span>s</h2></div></div>
				    </div><!-- /grid-b -->
			    
          
        </div> <!-- ui corner all -->
        <!-- airway task -->
        
        
        <!--b task -->
        <div class="ui-corner-all">
          
          <div class="ui-bar ui-bar-b">
            
            <h3 data-simtasktype="btask">BBBBBBBB</h3>
            <h3 data-taskdesc="BLabelling">description</h3>
          </div>

            <div class="ui-grid-b">
					    <div class="ui-block-a"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Occured</h1><p></p><h2><span data-omins="B1timemarkIminsInput"/>0</span>m <span data-osecs="B1timemarkIsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-b"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Identified</h1><p></p><h2><span data-imins="B1timemarkOminsInput"/>0</span>m <span data-isecs="B1timemarkOsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-c"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Treated</h1><p></p><h2><span data-tmins="B1timemarkTminsInput"/>0</span>m <span data-tsecs="B1timemarkTsecsInput">0</span>s</h2></div></div>
				    </div><!-- /grid-b -->
			    

        </div> <!-- ui corner all -->
        <!-- b task -->
        
        <!--c task -->
        <div class="ui-corner-all">
          
          <div class="ui-bar ui-bar-b">
            
            <h3 data-simtasktype="ctask">C</h3>
            <h3 data-taskdesc="CLabelling">description</h3>
          </div>

            <div class="ui-grid-b">
					    <div class="ui-block-a"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Occured</h1><p></p><h2><span data-omins="C1timemarkIminsInput"/>0</span>m <span data-osecs="C1timemarkIsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-b"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Identified</h1><p></p><h2><span data-imins="C1timemarkOminsInput"/>0</span>m <span data-isecs="C1timemarkOsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-c"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Treated</h1><p></p><h2><span data-tmins="C1timemarkTminsInput"/>0</span>m <span data-tsecs="C1timemarkTsecsInput">0</span>s</h2></div></div>
				    </div><!-- /grid-b -->
			    

        </div> <!-- ui corner all -->
        <!-- c task -->
        <!--d task -->
        <div class="ui-corner-all">
          
          <div class="ui-bar ui-bar-b">
            
            <h3 data-simtasktype="dtask">DD</h3>
            <h3 data-taskdesc="DLabelling">description</h3>
          </div>

            <div class="ui-grid-b">
					    <div class="ui-block-a"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Occured</h1><p></p><h2><span data-omins="D1timemarkIminsInput"/>0</span>m <span data-osecs="D1timemarkIsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-b"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Identified</h1><p></p><h2><span data-imins="D1timemarkOminsInput"/>0</span>m <span data-isecs="D1timemarkOsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-c"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Treated</h1><p></p><h2><span data-tmins="D1timemarkTminsInput"/>0</span>m <span data-tsecs="D1timemarkTsecsInput">0</span>s</h2></div></div>
				    </div><!-- /grid-b -->
			    

        </div> <!-- ui corner all -->
        <!-- d task -->
        
        <!--e task -->
        <div class="ui-corner-all">
          
          <div class="ui-bar ui-bar-b">
            
            <h3 data-simtasktype="etask">EE</h3>
            <h3 data-taskdesc="ELabelling">description</h3>
          </div>

            <div class="ui-grid-b">
					    <div class="ui-block-a"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Occured</h1><p></p><h2><span data-omins="E1timemarkIminsInput"/>0</span>m <span data-osecs="E1timemarkIsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-b"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Identified</h1><p></p><h2><span data-imins="E1timemarkOminsInput"/>0</span>m <span data-isecs="E1timemarkOsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-c"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Treated</h1><p></p><h2><span data-tmins="E1timemarkTminsInput"/>0</span>m <span data-tsecs="E1timemarkTsecsInput">0</span>s</h2></div></div>
				    </div><!-- /grid-b -->
			    

        </div> <!-- ui corner all -->
        <!-- d task -->
        
        <!--key events task -->
        <div class="ui-corner-all">
          
          <div class="ui-bar ui-bar-b">
            
          <h3>Key Events</h3>
          

          </div>

            <div class="ui-grid-a">
              
              <div class="ui-block-a"><div class="ui-bar ui-bar-b" ><h3><span data-taskdesc="KPLabelling"></span></h3></div></div>
					    <div class="ui-block-b"><div class="ui-bar ui-bar-b" ><h3><span data-taskdesc="KTLabelling"></span></h3></div></div>
					    
					    
					    
					    <div class="ui-block-a"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Identified</h1><p></p><h2><span data-imins="K1timemarkIminsInput"/>0</span>m <span data-isecs="K1timemarkIsecsInput">0</span>s</h2></div></div>
					    <div class="ui-block-b"><div class="ui-bar ui-bar-a" style="height:60px"><h1>Treated</h1><p></p><h2><span data-tmins="K1timemarkTminsInput"/>0</span>m <span data-tsecs="K1timemarkTsecsInput">0</span>s</h2></div></div>
					    
				    </div><!-- /grid-b -->
			    

        </div> <!-- ui corner all -->
        <!-- key events -->
        
        
      </div> <!-- div data role main -->
      

</div>
<!-- new page for table view -->

<script>

function circleprep() {


  //start

  var maxtimeval = findmaxtimeval();
  if (maxtimeval == null) {

    alert("internal error: max time not calculated");

    maxtimeval = 300;
  }

  var keyprobtime = gettimevalue(document.getElementById("K1timemarkIminsInput").value, document.getElementById("K1timemarkIsecsInput").value); // Value of where the line will appear
  if (keyprobtime == 0) {

    keyprobtime = null;
  }


  var keyrxtime = gettimevalue(document.getElementById("K1timemarkTminsInput").value, document.getElementById("K1timemarkTsecsInput").value); // Value of where the line will appear
  if (keyrxtime == 0) {

    keyrxtime = null;
  }

  var identtime = " ("+document.getElementById("K1timemarkIminsInput").value+"m "+ document.getElementById("K1timemarkIsecsInput").value+"s"+")";

  var ttime = " ("+document.getElementById("K1timemarkTminsInput").value+"m "+ document.getElementById("K1timemarkTsecsInput").value+"s"+")";


    
  var container_chartFreqAtaTailNum = new Highcharts.Chart({


    chart: {
      events: {
        load: function() {
          var label = this.renderer.label("A: " + $("#AirWaySetup").val())
            .css({
              width: 400,
              height: 100,
              color: 'black',
              fontSize: '12px'
            })
            .attr({
              'stroke': 'silver',
              'stroke-width': 2,
              'r': 5,
              'padding': 5
            })
            .add();

          label.align(Highcharts.extend(label.getBBox(), {
            align: 'bottom',
            x: 0, // offset
            verticalAlign: 'bottom',
            y: label.getBBox().height, // offset
          }), null, 'spacingBox');

          var labelB = this.renderer.label("B: " + $("#BSetup").val())
            .css({
              width: 400,
              height: 100,
              color: 'black',
              fontSize: '12px'
            })
            .attr({
              'stroke': 'silver',
              'stroke-width': 2,
              'r': 5,
              'padding': 5
            })
            .add();

          labelB.align(Highcharts.extend(label.getBBox(), {
            align: 'bottom',
            x: label.getBBox().width, // offset
            verticalAlign: 'bottom',
            y: label.getBBox().height, // offset
          }), null, 'spacingBox');

          var labelC = this.renderer.label("C: " + $("#CSetup").val())
            .css({
              width: 400,
              height: 100,
              color: 'black',
              fontSize: '12px'
            })
            .attr({
              'stroke': 'silver',
              'stroke-width': 2,
              'r': 5,
              'padding': 5
            })
            .add();

          labelC.align(Highcharts.extend(label.getBBox(), {
            align: 'bottom',
            x: 0, // offset
            verticalAlign: 'bottom',
            y: label.getBBox().height * 2, // offset
          }), null, 'spacingBox');

          var labelD = this.renderer.label("D: " + $("#DSetup").val())
            .css({
              width: 400,
              height: 100,
              color: 'black',
              fontSize: '12px'
            })
            .attr({
              'stroke': 'silver',
              'stroke-width': 2,
              'r': 5,
              'padding': 5
            })
            .add();

          labelD.align(Highcharts.extend(label.getBBox(), {
            align: 'bottom',
            x: labelC.getBBox().width, // offset
            verticalAlign: 'bottom',
            y: label.getBBox().height * 2, // offset
          }), null, 'spacingBox');


          var labelE = this.renderer.label("E: " + $("#ESetup").val())
            .css({
              width: 400,
              height: 100,
              color: 'black',
              fontSize: '12px'
            })
            .attr({
              'stroke': 'silver',
              'stroke-width': 2,
              'r': 5,
              'padding': 5
            })
            .add();

          labelE.align(Highcharts.extend(label.getBBox(), {
            align: 'bottom',
            x: labelC.getBBox().width + labelD.getBBox().width, // offset
            verticalAlign: 'bottom',
            y: label.getBBox().height * 2, // offset
          }), null, 'spacingBox');

          var labelKP = this.renderer.label("Key Problem: " + $("#KPSetup").val())
            .css({
              width: 400,
              height: 100,
              color: 'black',
              fontSize: '12px'
            })
            .attr({
              'stroke': 'silver',
              'stroke-width': 2,
              'r': 5,
              'padding': 5
            })
            .add();

          labelKP.align(Highcharts.extend(label.getBBox(), {
            align: 'bottom',
            x: 0, // offset
            verticalAlign: 'bottom',
            y: label.getBBox().height * 2 + labelC.getBBox().height // offset
          }), null, 'spacingBox');

          var labelKT = this.renderer.label("Definitive Treatment: " + $("#KTSetup").val())
            .css({
              width: 400,
              height: 100,
              color: 'black',
              fontSize: '12px'
            })
            .attr({
              'stroke': 'silver',
              'stroke-width': 2,
              'r': 5,
              'padding': 5
            })
            .add();

          labelKT.align(Highcharts.extend(label.getBBox(), {
            align: 'bottom',
            x: labelKP.getBBox().width, // offset
            verticalAlign: 'bottom',
            y: label.getBBox().height * 2 + labelC.getBBox().height // offset// offset
          }), null, 'spacingBox');
        }
      },

      spacingBottom: 100,
      type: 'bubble',
      plotBorderWidth: 1,
      inverted: true,
      zoomType: 'xy',
      renderTo: 'circlecontainer'
    },
    credits: {
      enabled: false

    },



    title: {
      text: 'Simulation Feedback'
    },



    subtitle: {
      text: ''
    },

    xAxis: {
      categories: ['A', 'B', 'C', 'D', 'E']
    },

    scrollbar: {
      enabled: false
    },

    yAxis: {
      plotLines: [{
          useHTML: true,
          color: 'red', // Color value
          label: {
            text: 'main problem identified'+identtime,
            verticalAlign: 'top',
            rotation: 0


          },
          value: keyprobtime,
          width: 2 // Width of the line
        },

        {
          color: 'blue', // Color value
          label: {
            text: 'key rx'+ttime,
            verticalAlign: 'bottom',
            rotation: 0
          },

          value: keyrxtime, // Value of where the line will appear
          width: 2 // Width of the line
        }
      ],

      min: 0,
      max: maxtimeval,
      tickInterval: 60,

      title: {
        text: 'Time (min)'
      },
      labels: {
        formatter: function() {


          return Math.floor(this.value / 60) + 'm';
        }

      },
    },



    plotOptions: {



      bubble: {

        minSize:20,
        maxSize:20,

        dataLabels: {



          enabled: true,

          align: 'center',




          formatter: function() {

            var labelstring = '';
            var minval = 0;
            var minval = Math.floor(this.y / 60);

            if (minval != 0) {
              var labelstring = minval + 'm ';
            }
            labelstring = labelstring + this.y % 60 + 's';

            return labelstring;
          }
        }
      }
    },

    legend: {
      enabled: true,
      align: 'right'
    },

    tooltip: {
        useHTML : true,
        headerFormat: '<b>{series.name}</b><br>',
        formatter: function() {

          var labelstring = '';
          var minval = 0;
          var minval = Math.floor(this.y / 60);

          if (minval != 0) {
            var labelstring = minval + 'm ';
          }
          
          var mytask="null";
          if (this.x=="A")
          {
            mytask = $("#AirWaySetup").val();
          }
          else if (this.x=="B")
          {
            mytask = $("#BSetup").val();
          }
          else if (this.x=="C")
          {
            mytask = $("#CSetup").val();
          }
          else if (this.x=="D")
          {
            mytask = $("#DSetup").val();
          }
          else if (this.x=="E")
          {
            mytask = $("#ESetup").val();
          }
          
          
          labelstring = "<b>" + mytask + "</b>" + "<br/>" + "(" + this.series.name + ")" +  "<br/>" + labelstring + this.y % 60 + 's';

          return labelstring;
        },
        

    },

    series: [
      {
        name: 'problem occured',

        data: [
          [gettimevalue(document.getElementById("A1timemarkIminsInput").value, document.getElementById("A1timemarkIsecsInput").value),1
          ],

          [gettimevalue(document.getElementById("B1timemarkIminsInput").value, document.getElementById("B1timemarkIsecsInput").value),2
          ],

          [gettimevalue(document.getElementById("C1timemarkIminsInput").value, document.getElementById("C1timemarkIsecsInput").value),3
          ],

          [gettimevalue(document.getElementById("D1timemarkIminsInput").value, document.getElementById("D1timemarkIsecsInput").value),4
          ],

          [gettimevalue(document.getElementById("E1timemarkIminsInput").value, document.getElementById("E1timemarkIsecsInput").value),5
          ]


        ],


        dataLabels: {
          enabled: true,
          xLow: -10,
          xHigh: 20,



        },

        color: 'red'
      },
      
      {
        name: 'problem identified',
        enabled: false,

        data: [
          [gettimevalue(document.getElementById("A1timemarkOminsInput").value, document.getElementById("A1timemarkOsecsInput").value), 1
          ],
          [gettimevalue(document.getElementById("B1timemarkOminsInput").value, document.getElementById("B1timemarkOsecsInput").value), 2
          ],
          [gettimevalue(document.getElementById("C1timemarkOminsInput").value, document.getElementById("C1timemarkOsecsInput").value), 3
          ],
          [gettimevalue(document.getElementById("D1timemarkOminsInput").value, document.getElementById("D1timemarkOsecsInput").value), 4
          ],
          [gettimevalue(document.getElementById("E1timemarkOminsInput").value, document.getElementById("E1timemarkOsecsInput").value), 5
          ]

        ],

        dataLabels: {
          enabled: true,
          xLow: -10,
          xHigh: 20,


        },

        color: 'yellow'

      },

      

      {
        name: 'problem treated',

        data: [
          [gettimevalue(document.getElementById("A1timemarkTminsInput").value, document.getElementById("A1timemarkTsecsInput").value), 1
          ],

          [gettimevalue(document.getElementById("B1timemarkTminsInput").value, document.getElementById("B1timemarkTsecsInput").value), 2
          ],

          [gettimevalue(document.getElementById("C1timemarkTminsInput").value, document.getElementById("C1timemarkTsecsInput").value), 3
          ],

          [gettimevalue(document.getElementById("D1timemarkTminsInput").value, document.getElementById("D1timemarkTsecsInput").value), 4
          ],

          [gettimevalue(document.getElementById("E1timemarkTminsInput").value, document.getElementById("E1timemarkTsecsInput").value), 5
          ]


        ],


        dataLabels: {
          enabled: true,
          xLow: -10,
          xHigh: 20,



        },

        color: 'green'
      }
    ]


    //dil
  });

  //end
}
  
  
  
</script>

  <div data-role="page" id="circleview" class="ui-corner-all" data-theme="b">
      <div data-role="header" data-position="fixed" data-theme="b">
        
      
        
        <div data-role="controlgroup" data-type="horizontal">
          
          <a href="#pageone" class="ui-btn" id="returnToSim">Return to simulation</a>
          <a href="#pagetwo" class="ui-btn" id="graphing">graph view</a>
          <a href="#tableview" class="ui-btn" id="tableview">table view</a>


        
        </div>
        </div> <!-- header end -->

     <div data-role="main" class="ui-content">


    <div data-role="main" class="ui-content">
      <div id="circlecontainer"></div>
    </div>


    </div>
        
       
          
        
      

  </div>

<!--end new page for table view -->


<div data-role="page" id="info" class="ui-corner-all" data-theme="b">
    
    
    
    <div data-role="header" data-position="fixed" data-theme="b">
      
      <div data-role="controlgroup" data-type="horizontal">
          
          <a href="#pageone" class="ui-btn" id="returnToSim">Return to simulation</a>

      </div>
    
    </div>

    <div data-role="main" class="ui-content">

      <div style="padding:10px 20px;">
        <h3>About this web application</h3>
        
        <a href=http://www.cureus.com/posters/1154-a-technology-aid-for-performance-assessment-in-paediatric-emergency-department-in-situ-simulation  target="_blank">The Graphics in Simulation Tool (GIST)</a> by <a href=http://em3.org.uk  target="_blank">EM3</a> is licensed under <a href=https://creativecommons.org/licenses/by/2.0/  target="_blank">CC BY 2.0</a>
        
        <p></p>
        This is a prototype <a href=http://www.cureus.com/posters/1154-a-technology-aid-for-performance-assessment-in-paediatric-emergency-department-in-situ-simulation  target="_blank">web application</a> for performance assessment in paediatric Emergency Department In-situ Simulation.  
         
         
      
        <p></p>
        This is a work in progress!  Please <a href="mailto:d@marikar.net?Subject=web%20app"  target="_blank">contact us</a> for queries and suggestions for improvement
        
        <p></p>
        Built with the following libraries: JQuery, JQuery Mobile, HighCharts, TimeCircles

      </div>

    </div>

  </div>

</body>

</html>
